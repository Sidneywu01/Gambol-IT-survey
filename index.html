<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>乖宝工厂系统使用调查（匿名）</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  h1 { font-size: 1.5em; margin-bottom: 10px; }
  h2 { margin-top: 25px; font-size: 1.2em; }
  .module { border: 1px solid #ccc; padding: 15px; margin-top: 15px; border-radius: 5px; background-color: #f9f9f9; }
  label { display: block; margin-top: 10px; }
  select, textarea, input[type="text"] { width: 100%; margin-top: 5px; padding: 5px; font-size: 1em; }
  input[type="checkbox"] { margin-right: 5px; }
  button { margin-top: 20px; padding: 10px 20px; font-size: 1em; }
</style>
</head>
<body>

<h1>乖宝（泰国）工厂数字化系统使用情况调查（匿名）</h1>
<p>为了更好地推动数字化系统落地并优化培训与流程，我们希望了解各系统的真实使用情况。此问卷匿名，数据仅用于系统改进。<br>
เพื่อพัฒนาการใช้งานระบบดิจิทัลของโรงงาน Gambol ประเทศไทย และปรับปรุงการฝึกอบรมและกระบวนการ เราต้องการข้อมูลการใช้งานจริงแบบไม่ระบุชื่อ ข้อมูลนี้ใช้เพื่อปรับปรุงระบบเท่านั้น</p>

<iframe name="hidden_iframe" style="display:none;"></iframe>

<form id="surveyForm" action="YOUR_DEPLOYED_SCRIPT_URL_HERE" method="POST" target="hidden_iframe">

  <!-- 部门选择 -->
  <label>您所在的部门 / แผนกของคุณ</label>
  <select name="department" required>
    <option value="">请选择部门 / โปรดเลือกแผนก</option>
    <option value="生产 / Production">生产 / Production</option>
    <option value="品质 / Quality">品质 / Quality</option>
    <option value="仓库 / 物流 / Warehouse / Logistics">仓库 / 物流 / Warehouse / Logistics</option>
    <option value="计划 / Planning">计划 / Planning</option>
    <option value="工程 / IE / Engineering / IE">工程 / IE / Engineering / IE</option>
    <option value="采购 / Procurement">采购 / Procurement</option>
    <option value="财务 / Finance">财务 / Finance</option>
    <option value="HR / 人事 / HR / Administration">HR / 人事 / HR / Administration</option>
    <option value="IT">IT</option>
    <option value="其他 / Other">其他 / Other</option>
  </select>

  <!-- 可选实名 -->
  <label>如果希望我们跟进问题，请留下姓名（可选） / หากต้องการให้ติดตามปัญหา กรุณากรอกชื่อ (ไม่บังคับ)</label>
  <input type="text" name="optional_name" placeholder="姓名 / ชื่อ">

  <!-- 系统选择 -->
  <label>请选择您日常使用的系统 / กรุณาเลือกระบบที่คุณใช้งานประจำวัน</label>
  <div id="systemCheckboxes">
    <label><input type="checkbox" name="systems" value="生管 MES"> 生管 MES / MES การผลิต</label>
    <label><input type="checkbox" name="systems" value="QMS"> QMS / QMS</label>
    <label><input type="checkbox" name="systems" value="WMS"> WMS / WMS</label>
    <label><input type="checkbox" name="systems" value="OA"> OA / OA</label>
    <label><input type="checkbox" name="systems" value="ERP"> ERP / ERP</label>
    <label><input type="checkbox" name="systems" value="PLM"> PLM / PLM</label>
  </div>

  <div id="modulesContainer"></div>

  <h2>整体反馈 / ความคิดเห็นโดยรวม</h2>
  <label>除了具体系统，您最希望数字化系统或新建系统能帮忙解决的问题是什么？（可包括线下流程痛点） / ปัญหาหลักที่คุณ希望ให้ระบบหรือระบบใหม่ช่วยแก้ไข (รวมถึงกระบวนการปัจจุบันที่ยังทำแบบออฟไลน์)</label>
  <textarea name="global_wish" rows="4"></textarea>

  <button type="submit">提交 / Submit / ส่ง</button>
</form>

<script>
const modulesContainer = document.getElementById('modulesContainer');

document.getElementById('systemCheckboxes').addEventListener('change', () => {
  const selected = Array.from(document.querySelectorAll('input[name="systems"]:checked')).map(cb => cb.value);
  renderModules(selected);
});

function renderModules(selectedSystems) {
  modulesContainer.innerHTML = '';
  selectedSystems.forEach(system => {
    const div = document.createElement('div');
    div.className = 'module';
    div.innerHTML = `
      <h2>${system} 系统模块调查 / แบบสอบถามระบบ ${system}</h2>

      <label>每天大约使用 ${system} 系统多少次？ / คุณใช้งานระบบ ${system} วันละกี่ครั้ง?</label>
      <select name="${system}_frequency" required>
        <option value="">请选择 / โปรดเลือก</option>
        <option value="1 次 / 1 ครั้ง">1 次 / 1 ครั้ง</option>
        <option value="2–3 次 / 2–3 ครั้ง">2–3 次 / 2–3 ครั้ง</option>
        <option value="4–5 次 / 4–5 ครั้ง">4–5 次 / 4–5 ครั้ง</option>
        <option value="5 次以上 / มากกว่า 5 ครั้ง">5 次以上 / มากกว่า 5 ครั้ง</option>
      </select>

      <label>每次操作平均耗时多久？ / ใช้เวลาต่อครั้งโดยประมาณเท่าไหร่</label>
      <select name="${system}_duration" required>
        <option value="">请选择 / โปรดเลือก</option>
        <option value="<5 分钟 / <5 นาที"><5 分钟 / <5 นาที</option>
        <option value="5–15 分钟 / 5–15 นาที">5–15 分钟 / 5–15 นาที</option>
        <option value="15–30 分钟 / 15–30 นาที">15–30 分钟 / 15–30 นาที</option>
        <option value=">30 分钟 / >30 นาที">>30 分钟 / >30 นาที</option>
      </select>

      <label>是否能独立完成操作？ / คุณสามารถทำงานเองโดยไม่ต้องพึ่ง IT หรือฝ่ายอื่นหรือไม่?</label>
      <select name="${system}_independent" required>
        <option value="">请选择 / โปรดเลือก</option>
        <option value="完全独立 / ใช้ได้ด้วยตนเองทั้งหมด">完全独立 / ใช้ได้ด้วยตนเองทั้งหมด</option>
        <option value="大部分独立 / ส่วนใหญ่ใช้ได้ ต้องการความช่วยเหลือบางครั้ง">大部分独立 / ส่วนใหญ่ใช้ได้ ต้องการความช่วยเหลือบางครั้ง</option>
        <option value="经常需要 IT 协助 / ต้องพึ่ง IT บ่อยครั้ง">经常需要 IT 协助 / ต้องพึ่ง IT บ่อยครั้ง</option>
        <option value="经常需要跨部门协作 / ต้องพึ่งฝ่ายอื่นบ่อยครั้ง">经常需要跨部门协作 / ต้องพึ่งฝ่ายอื่นบ่อยครั้ง</option>
        <option value="完全不能独立 / ไม่สามารถใช้งานเองได้">完全不能独立 / ไม่สามารถใช้งานเองได้</option>
      </select>

      <label>每天大约需要多少次 IT 协助？ / ต้องพึ่ง IT ประมาณกี่ครั้งต่อวัน</label>
      <select name="${system}_it_support" required>
        <option value="">请选择 / โปรดเลือก</option>
        <option value="0 次 / 0 ครั้ง">0 次 / 0 ครั้ง</option>
        <option value="1 次 / 1 ครั้ง">1 次 / 1 ครั้ง</option>
        <option value="2–3 次 / 2–3 ครั้ง">2–3 次 / 2–3 ครั้ง</option>
        <option value="4–5 次 / 4–5 ครั้ง">4–5 次 / 4–5 ครั้ง</option>
        <option value="5 次以上 / มากกว่า 5 ครั้ง">5 次以上 / มากกว่า 5 ครั้ง</option>
      </select>

      <label>需要 IT 协助的主要原因（可多选） / สาเหตุหลักที่ต้องพึ่ง IT (เลือกได้หลายข้อ)</label>
      <label><input type="checkbox" name="${system}_it_reason" value="操作不熟 / ไม่คุ้นเคยการใช้งาน"> 操作不熟 / ไม่คุ้นเคยการใช้งาน</label>
      <label><input type="checkbox" name="${system}_it_reason" value="功能不足 / Bug / ฟังก์ชันไม่ครบ / Bug"> 功能不足 / Bug / ฟังก์ชันไม่ครบ / Bug</label>
      <label><input type="checkbox" name="${system}_it_reason" value="数据不正确 / ข้อมูลไม่ถูกต้อง"> 数据不正确 / ข้อมูลไม่ถูกต้อง</label>
      <label><input type="checkbox" name="${system}_it_reason" value="权限问题 / ปัญหาสิทธิ์"> 权限问题 / ปัญหาสิทธิ์</label>
      <label><input type="checkbox" name="${system}_it_reason" value="流程跨部门 / กระบวนการต้องประสานกับฝ่ายอื่น"> 流程跨部门 / กระบวนการต้องประสานกับฝ่ายอื่น</label>
      <label><input type="checkbox" name="${system}_it_reason" value="紧急问题 / ปัญหาเร่งด่วน"> 紧急问题 / ปัญหาเร่งด่วน</label>
      <label><input type="checkbox" name="${system}_it_reason" value="其他 / อื่นๆ"> 其他 / อื่นๆ</label>

      <label>使用该系统是否需与其他部门沟通？ / ในการใช้งานระบบนี้ ต้องประสานงานกับฝ่ายอื่นหรือไม่?</label>
      <select name="${system}_cross_department" required>
        <option value="">请选择 / โปรดเลือก</option>
        <option value="经常需要 / ต้องประสานบ่อยครั้ง">经常需要 / ต้องประสานบ่อยครั้ง</option>
        <option value="偶尔需要 / บางครั้ง">偶尔需要 / บางครั้ง</option>
        <option value="基本不需要 / แทบไม่ต้อง">基本不需要 / แทบไม่ต้อง</option>
      </select>

      <label>整体满意度（1-5） / คุณพอใจกับระบบมากน้อยแค่ไหน (1-5)</label>
      <select name="${system}_satisfaction" required>
        <option value="">请选择 / โปรดเลือก</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
      </select>

      <label>希望系统改进的方面（可多选） / ระบบควรพัฒนาด้านใด (เลือกได้หลายข้อ)</label>
      <label><input type="checkbox" name="${system}_improve" value="功能 / ฟังก์ชัน"> 功能 / ฟังก์ชัน</label>
      <label><input type="checkbox" name="${system}_improve" value="流程 / กระบวนการ"> 流程 / กระบวนการ</label>
      <label><input type="checkbox" name="${system}_improve" value="培训 / การฝึกอบรม"> 培训 / การฝึกอบรม</label>
      <label><input type="checkbox" name="${system}_improve" value="界面 / ส่วนติดต่อผู้ใช้"> 界面 / ส่วนติดต่อผู้ใช้</label>
      <label><input type="checkbox" name="${system}_improve" value="权限 / สิทธิ์"> 权限 / สิทธิ์</label>
      <label><input type="checkbox" name="${system}_improve" value="其他 / อื่นๆ"> 其他 / อื่นๆ</label>

      <label>最希望该系统解决的问题 / 线下痛点 / ปัญหาหลักที่คุณ希望ให้ระบบหรือระบบใหม่ช่วยแก้ไข</label>
      <textarea name="${system}_wish" rows="3"></textarea>
    `;
    modulesContainer.appendChild(div);
  });
}

// 提交提示
const form = document.getElementById('surveyForm');
const iframe = document.querySelector('iframe[name="hidden_iframe"]');
iframe.onload = function() {
  if (!form._submitted) return;
  alert("表单已提交，谢谢参与 / ขอบคุณสำหรับการตอบแบบสอบถาม");
  form.reset();
  modulesContainer.innerHTML = '';
  form._submitted = false;
};
form.addEventListener('submit', function() {
  form._submitted = true;
});
</script>
</body>
</html>
